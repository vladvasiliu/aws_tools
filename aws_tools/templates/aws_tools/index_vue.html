<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>AWSTools â€¢ VueJS</title>
    <script src="https://unpkg.com/vue"></script>
    <script src="https://unpkg.com/vuex"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
</head>
<body>
<div id="app">
    {% verbatim %}
    <ul>
        <li v-for="account in aws_accounts">
            {{ account.role_arn }}
        </li>
    </ul>
    {% endverbatim %}
</div>
</body>
<script>
    const store = new Vuex.Store({
        string: true,
        state: {
            aws_accounts: []
        },
        actions: {
            LOAD_AWS_ACCOUNT_LIST: function({ commit }) {
                axios.get('{% url "awsaccount-list" %}').then((response) => {
                    commit('SET_ACCOUNT_LIST', { list: response.data })
                }, (err) => {
                    console.log(err)
                })
            }
        },
        mutations: {
            SET_ACCOUNT_LIST: (state, { list }) => { state.aws_accounts = list }
        },
    });

    var app = new Vue({
        el: '#app',
        computed: {
            aws_accounts (){ return store.state.aws_accounts },
        },
        mounted: function () {
            store.dispatch('LOAD_AWS_ACCOUNT_LIST');
        }
    })
</script>
</html>